{
    "sourceFile": ".github/workflows/deploy.yml",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1748189550858,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748189623706,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n name: Deploy to GitHub Pages\r\n \r\n on:\r\n   push:\r\n-    branches: [ main ]\r\n+    branches: [ thausif, main ] \r\n   workflow_dispatch:  # Allows manual triggering from the GitHub UI\r\n \r\n jobs:\r\n   build-and-deploy:\r\n"
                },
                {
                    "date": 1748189799489,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,19 +26,41 @@\n       - name: Build\r\n         working-directory: ./Frontend\r\n         run: npm run build -- --configuration production --base-href=/AdvSoftTech-Assignment/\r\n \r\n-      - name: Copy index.html to 404.html\r\n-        working-directory: ./Frontend/dist/coreui-free-angular-admin-template\r\n-        run: cp index.html 404.html\r\n+      # Debug step to find build output directory\r\n+      - name: List build output directories\r\n+        run: |\r\n+          echo \"Listing build output directories:\"\r\n+          find Frontend/dist -type d | sort\r\n+          echo \"Listing HTML files:\"\r\n+          find Frontend/dist -name \"*.html\" | sort\r\n \r\n-      - name: Add .nojekyll file\r\n-        working-directory: ./Frontend/dist/coreui-free-angular-admin-template\r\n-        run: touch .nojekyll\r\n+      # Dynamically find the correct build output directory\r\n+      - name: Find build directory and prepare for deployment\r\n+        id: find-build-dir\r\n+        run: |\r\n+          BUILD_DIR=$(find Frontend/dist -type d -maxdepth 1 | head -n 2 | tail -n 1)\r\n+          echo \"Found build directory: $BUILD_DIR\"\r\n+          echo \"build_dir=$BUILD_DIR\" >> $GITHUB_OUTPUT\r\n+          \r\n+          # Check if index.html exists\r\n+          if [ -f \"$BUILD_DIR/index.html\" ]; then\r\n+            echo \"Found index.html, creating 404.html\"\r\n+            cp \"$BUILD_DIR/index.html\" \"$BUILD_DIR/404.html\"\r\n+          else\r\n+            echo \"WARNING: index.html not found in $BUILD_DIR\"\r\n+            find Frontend/dist -name \"index.html\"\r\n+          fi\r\n+          \r\n+          # Create .nojekyll file\r\n+          touch \"$BUILD_DIR/.nojekyll\"\r\n+          echo \"Created .nojekyll file\"\r\n \r\n+      # Deploy using the dynamically found directory\r\n       - name: Deploy to GitHub Pages\r\n         uses: JamesIves/github-pages-deploy-action@v4\r\n         with:\r\n-          folder: Frontend/dist/coreui-free-angular-admin-template\r\n+          folder: ${{ steps.find-build-dir.outputs.build_dir }}\r\n           branch: gh-pages\r\n           token: ${{ secrets.GITHUB_TOKEN }}\r\n           clean: true\n\\ No newline at end of file\n"
                },
                {
                    "date": 1748190291241,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n \r\n on:\r\n   push:\r\n     branches: [ thausif, main ] \r\n-  workflow_dispatch:  # Allows manual triggering from the GitHub UI\r\n+  workflow_dispatch:\r\n \r\n jobs:\r\n   build-and-deploy:\r\n     runs-on: ubuntu-latest\r\n@@ -26,41 +26,12 @@\n       - name: Build\r\n         working-directory: ./Frontend\r\n         run: npm run build -- --configuration production --base-href=/AdvSoftTech-Assignment/\r\n \r\n-      # Debug step to find build output directory\r\n-      - name: List build output directories\r\n-        run: |\r\n-          echo \"Listing build output directories:\"\r\n-          find Frontend/dist -type d | sort\r\n-          echo \"Listing HTML files:\"\r\n-          find Frontend/dist -name \"*.html\" | sort\r\n-\r\n-      # Dynamically find the correct build output directory\r\n-      - name: Find build directory and prepare for deployment\r\n-        id: find-build-dir\r\n-        run: |\r\n-          BUILD_DIR=$(find Frontend/dist -type d -maxdepth 1 | head -n 2 | tail -n 1)\r\n-          echo \"Found build directory: $BUILD_DIR\"\r\n-          echo \"build_dir=$BUILD_DIR\" >> $GITHUB_OUTPUT\r\n-          \r\n-          # Check if index.html exists\r\n-          if [ -f \"$BUILD_DIR/index.html\" ]; then\r\n-            echo \"Found index.html, creating 404.html\"\r\n-            cp \"$BUILD_DIR/index.html\" \"$BUILD_DIR/404.html\"\r\n-          else\r\n-            echo \"WARNING: index.html not found in $BUILD_DIR\"\r\n-            find Frontend/dist -name \"index.html\"\r\n-          fi\r\n-          \r\n-          # Create .nojekyll file\r\n-          touch \"$BUILD_DIR/.nojekyll\"\r\n-          echo \"Created .nojekyll file\"\r\n-\r\n-      # Deploy using the dynamically found directory\r\n+      # Simplified deployment that works with the correct output path\r\n       - name: Deploy to GitHub Pages\r\n         uses: JamesIves/github-pages-deploy-action@v4\r\n         with:\r\n-          folder: ${{ steps.find-build-dir.outputs.build_dir }}\r\n+          folder: Frontend/dist/coreui-free-angular-admin-template\r\n           branch: gh-pages\r\n-          token: ${{ secrets.GITHUB_TOKEN }}\r\n+          token: ${{ secrets.DEPLOY_TOKEN }}  # Use the custom token\r\n           clean: true\n\\ No newline at end of file\n"
                },
                {
                    "date": 1748190901314,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,37 +1,75 @@\n name: Deploy to GitHub Pages\r\n \r\n on:\r\n   push:\r\n-    branches: [ thausif, main ] \r\n+    branches:\r\n+      - main\r\n+      - thausif\r\n+  # Allow manual triggering\r\n   workflow_dispatch:\r\n \r\n+# Add permissions block\r\n+permissions:\r\n+  contents: write\r\n+\r\n jobs:\r\n   build-and-deploy:\r\n     runs-on: ubuntu-latest\r\n     steps:\r\n-      - name: Checkout\r\n-        uses: actions/checkout@v3\r\n+      - name: Checkout code\r\n+        uses: actions/checkout@v4\r\n \r\n-      - name: Set up Node.js\r\n-        uses: actions/setup-node@v3\r\n+      - name: Setup Node.js\r\n+        uses: actions/setup-node@v4\r\n         with:\r\n-          node-version: '20'\r\n+          node-version: 20\r\n           cache: 'npm'\r\n-          cache-dependency-path: 'Frontend/package-lock.json'\r\n+          cache-dependency-path: './Frontend/package-lock.json'\r\n \r\n       - name: Install dependencies\r\n-        working-directory: ./Frontend\r\n-        run: npm ci\r\n+        run: |\r\n+          cd Frontend\r\n+          npm ci --legacy-peer-deps\r\n \r\n-      - name: Build\r\n-        working-directory: ./Frontend\r\n-        run: npm run build -- --configuration production --base-href=/AdvSoftTech-Assignment/\r\n+      - name: Update base URL for GitHub Pages\r\n+        run: |\r\n+          cd Frontend\r\n+          sed -i 's/<base href=\"\\/\">/<base href=\"\\/AdvSoftTech-Assignment\\/\">/' src/index.html\r\n+      \r\n+      - name: Build Angular project\r\n+        run: |\r\n+          cd Frontend\r\n+          npm run build -- --configuration production --base-href=/AdvSoftTech-Assignment/ --legacy-peer-deps\r\n \r\n-      # Simplified deployment that works with the correct output path\r\n+      - name: Debug directory structure\r\n+        run: |\r\n+          find Frontend/dist -type d | sort\r\n+          find Frontend/dist -name \"index.html\" -type f\r\n+\r\n+      # Fix the variable capture so it's available for the deploy step\r\n+      - name: Add routing files and set output\r\n+        id: find-output\r\n+        run: |\r\n+          # Find the directory containing index.html\r\n+          INDEX_DIR=$(find Frontend/dist -name \"index.html\" -type f | xargs dirname)\r\n+          if [ -n \"$INDEX_DIR\" ]; then\r\n+            echo \"Found index.html in $INDEX_DIR\"\r\n+            cd \"$INDEX_DIR\"\r\n+            \r\n+            # Create necessary files for GitHub Pages\r\n+            echo \"/* /index.html 200\" > _redirects\r\n+            cp index.html 404.html\r\n+            touch .nojekyll\r\n+            \r\n+            echo \"output_dir=$INDEX_DIR\" >> $GITHUB_OUTPUT\r\n+          else\r\n+            echo \"Error: Could not find index.html in build output\"\r\n+            exit 1\r\n+          fi\r\n+\r\n       - name: Deploy to GitHub Pages\r\n         uses: JamesIves/github-pages-deploy-action@v4\r\n         with:\r\n-          folder: Frontend/dist/coreui-free-angular-admin-template\r\n+          folder: ${{ steps.find-output.outputs.output_dir || 'Frontend/dist/coreui-free-angular-admin-template' }}\r\n           branch: gh-pages\r\n-          token: ${{ secrets.DEPLOY_TOKEN }}  # Use the custom token\r\n           clean: true\n\\ No newline at end of file\n"
                },
                {
                    "date": 1748191012420,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n       \r\n       - name: Build Angular project\r\n         run: |\r\n           cd Frontend\r\n-          npm run build -- --configuration production --base-href=/AdvSoftTech-Assignment/ --legacy-peer-deps\r\n+          npm run build -- --configuration production --base-href=/AdvSoftTech-Assignment/\r\n \r\n       - name: Debug directory structure\r\n         run: |\r\n           find Frontend/dist -type d | sort\r\n"
                }
            ],
            "date": 1748189550858,
            "name": "Commit-0",
            "content": "name: Deploy to GitHub Pages\r\n\r\non:\r\n  push:\r\n    branches: [ main ]\r\n  workflow_dispatch:  # Allows manual triggering from the GitHub UI\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v3\r\n\r\n      - name: Set up Node.js\r\n        uses: actions/setup-node@v3\r\n        with:\r\n          node-version: '20'\r\n          cache: 'npm'\r\n          cache-dependency-path: 'Frontend/package-lock.json'\r\n\r\n      - name: Install dependencies\r\n        working-directory: ./Frontend\r\n        run: npm ci\r\n\r\n      - name: Build\r\n        working-directory: ./Frontend\r\n        run: npm run build -- --configuration production --base-href=/AdvSoftTech-Assignment/\r\n\r\n      - name: Copy index.html to 404.html\r\n        working-directory: ./Frontend/dist/coreui-free-angular-admin-template\r\n        run: cp index.html 404.html\r\n\r\n      - name: Add .nojekyll file\r\n        working-directory: ./Frontend/dist/coreui-free-angular-admin-template\r\n        run: touch .nojekyll\r\n\r\n      - name: Deploy to GitHub Pages\r\n        uses: JamesIves/github-pages-deploy-action@v4\r\n        with:\r\n          folder: Frontend/dist/coreui-free-angular-admin-template\r\n          branch: gh-pages\r\n          token: ${{ secrets.GITHUB_TOKEN }}\r\n          clean: true"
        }
    ]
}