import{a as Q}from"./chunk-K2B6UWH3.js";import{a as ae}from"./chunk-4UA6PHYX.js";import{b as W,c as g,d as Z,e as ee,l as te,n as ne,p as ie,t as re,w as oe}from"./chunk-NOLICJZN.js";import"./chunk-ZY66MEJT.js";import{A as F,B as D,J as V,Ja as $,N,Na as q,O as L,P as B,Ra as U,Ua as J,Wa as X,X as G,Ya as K,Z as H,da as Y,e as T,g as O,ka as z,la as A,m as w,ma as j,oa as R}from"./chunk-L2SPN6SO.js";import{$b as f,Db as a,Fb as x,Ob as t,Pb as e,Qb as l,Ub as I,Zb as b,bb as o,gb as v,la as C,lc as n,ma as h,na as d,nc as y,oa as p,oc as k,pb as E,vb as u,zc as _}from"./chunk-EBI22OCP.js";import{a as M}from"./chunk-7CGTOI24.js";var S=r=>({"is-invalid":r});function se(r,m){r&1&&(t(0,"c-alert",25),n(1," You're currently on the "),t(2,"strong"),n(3,"Free Plan"),e(),n(4,". Upgrade to Pro for advanced features! "),e())}function ce(r,m){r&1&&(t(0,"c-alert",26)(1,"strong"),n(2,"Thank you for being a Pro subscriber!"),e(),n(3," You have access to all premium features. "),e())}function le(r,m){r&1&&(t(0,"c-alert",27)(1,"strong"),n(2,"You're currently subscribed to the Pro Plan!"),e(),t(3,"p",28),n(4,"Enjoy all premium features including Bulk CSV Prediction."),e()())}function me(r,m){r&1&&(t(0,"span"),n(1,"Current Plan"),e())}function de(r,m){r&1&&(t(0,"span"),n(1,"Basic Plan"),e())}function pe(r,m){r&1&&(t(0,"span"),n(1,"Select Plan"),e())}function ue(r,m){r&1&&(t(0,"span"),n(1,"Cancel Plan"),e())}function fe(r,m){if(r&1&&(t(0,"div",40)(1,"div",41),d(),l(2,"svg",42),e(),p(),t(3,"c-alert",43)(4,"strong"),n(5,"Payment successful!"),e(),l(6,"br"),n(7),l(8,"br"),t(9,"small"),n(10,"Redirecting to dashboard to try Bulk Prediction..."),e()()()),r&2){let i=f(2);o(7),y(" You are now subscribed to the ",i.selectedPlan==null?null:i.selectedPlan.name,".")}}function ge(r,m){if(r&1&&(t(0,"c-alert",44),n(1),e()),r&2){let i=f(2);o(),y(" ",i.paymentError," ")}}function ve(r,m){r&1&&(t(0,"div",59),n(1," Name on card is required "),e())}function be(r,m){r&1&&(t(0,"div",59),n(1," Please enter a valid 16-digit card number "),e())}function _e(r,m){r&1&&(t(0,"div",59),n(1," Enter a valid expiry date (MM/YY) "),e())}function Ce(r,m){r&1&&(t(0,"div",59),n(1," Enter a valid CVV (3-4 digits) "),e())}function he(r,m){if(r&1&&(t(0,"div")(1,"h4",45),n(2),e(),t(3,"p"),n(4,"Please enter your payment information to complete the subscription."),e(),t(5,"form",46)(6,"div",47)(7,"label",48),n(8,"Name on Card"),e(),l(9,"input",49),u(10,ve,2,0,"div",50),e(),t(11,"div",47)(12,"label",51),n(13,"Card Number"),e(),l(14,"input",52),u(15,be,2,0,"div",50),e(),t(16,"div",53)(17,"div",54)(18,"label",55),n(19,"Expiry Date"),e(),l(20,"input",56),u(21,_e,2,0,"div",50),e(),t(22,"div",54)(23,"label",57),n(24,"CVV"),e(),l(25,"input",58),u(26,Ce,2,0,"div",50),e()()()()),r&2){let i=f(2);o(2),k("",i.selectedPlan==null?null:i.selectedPlan.name," - $",i.selectedPlan==null?null:i.selectedPlan.price," per month"),o(3),a("formGroup",i.paymentForm),o(4),a("ngClass",_(11,S,i.hasInvalidClass("cardName"))),o(),a("ngIf",i.hasInvalidClass("cardName")),o(4),a("ngClass",_(13,S,i.hasInvalidClass("cardNumber"))),o(),a("ngIf",i.hasInvalidClass("cardNumber")),o(5),a("ngClass",_(15,S,i.hasInvalidClass("expiryDate"))),o(),a("ngIf",i.hasInvalidClass("expiryDate")),o(4),a("ngClass",_(17,S,i.hasInvalidClass("cvv"))),o(),a("ngIf",i.hasInvalidClass("cvv"))}}function Se(r,m){r&1&&(t(0,"span"),n(1,"Complete Payment"),e())}function xe(r,m){r&1&&(t(0,"span"),n(1,"Processing..."),e())}function ye(r,m){if(r&1){let i=I();t(0,"div",29)(1,"div",30)(2,"div",31)(3,"div",32)(4,"h5"),n(5,"Complete Your Subscription"),e(),t(6,"button",33),b("click",function(){C(i);let s=f();return h(s.closeModal())}),n(7,"\xD7"),e()(),t(8,"div",34),u(9,fe,11,1,"div",35)(10,ge,2,1,"c-alert",36)(11,he,27,19,"div",18),e(),t(12,"div",37)(13,"button",38),b("click",function(){C(i);let s=f();return h(s.closeModal())}),n(14," Cancel "),e(),t(15,"button",39),b("click",function(){C(i);let s=f();return h(s.processPurchase())}),u(16,Se,2,0,"span",18)(17,xe,2,0,"span",18),e()()()()()}if(r&2){let i=f();o(9),a("ngIf",i.paymentSuccess),o(),a("ngIf",i.paymentError),o(),a("ngIf",!i.paymentSuccess),o(4),a("disabled",i.processing||i.paymentSuccess),o(),a("ngIf",!i.processing),o(),a("ngIf",i.processing)}}var $e=(()=>{class r{constructor(i,c,s,P){this.subscriptionService=i,this.fb=c,this.router=s,this.iconSetService=P,this.subscriptionPlans=[],this.currentSubscription="free",this.showPaymentModal=!1,this.selectedPlan=null,this.processing=!1,this.paymentSuccess=!1,this.paymentError="",this.isDarkMode=!1,this.iconSetService.icons=M({},Q),this.paymentForm=this.fb.group({cardName:["",[g.required]],cardNumber:["",[g.required,g.pattern(/^\d{16}$/)]],expiryDate:["",[g.required,g.pattern(/^\d{2}\/\d{2}$/)]],cvv:["",[g.required,g.pattern(/^\d{3,4}$/)]]})}ngOnInit(){this.subscriptionPlans=this.subscriptionService.getSubscriptionPlans(),this.currentSubscription=this.subscriptionService.getCurrentSubscription(),this.subscriptionService.checkBackendSubscriptionStatus(),setTimeout(()=>{this.currentSubscription=this.subscriptionService.getCurrentSubscription(),console.log("Updated current subscription:",this.currentSubscription)},1e3),this.isDarkMode=document.body.classList.contains("dark-theme"),document.addEventListener("themeChange",()=>{this.isDarkMode=document.body.classList.contains("dark-theme")}),console.log("Component initialized, subscription plans:",this.subscriptionPlans),console.log("Current subscription:",this.currentSubscription),console.log("Dark mode:",this.isDarkMode)}selectPlan(i){if(console.log("Plan selected:",i),i.id==="free"){this.subscriptionService.setSubscription("free"),this.currentSubscription="free",setTimeout(()=>{this.router.navigate(["/dashboard"])},1e3);return}this.selectedPlan=i,this.showPaymentModal=!0,console.log("Payment modal should be visible:",this.showPaymentModal),setTimeout(()=>{document.body.classList.add("modal-open")},0)}closeModal(){this.showPaymentModal=!1,this.selectedPlan=null,this.paymentForm.reset(),this.paymentSuccess=!1,this.paymentError="",document.body.classList.remove("modal-open")}processPurchase(){if(this.paymentForm.invalid){this.paymentForm.markAllAsTouched();return}if(this.processing=!0,this.paymentError="",this.selectedPlan){let i=this.selectedPlan.id;this.subscriptionService.processPurchase(i,this.paymentForm.value).subscribe({next:c=>{this.processing=!1,c&&(this.paymentSuccess=!0,this.subscriptionService.setSubscription(i),this.currentSubscription=i,setTimeout(()=>{this.closeModal(),this.router.navigate(["/dashboard/bulk"])},2e3))},error:c=>{this.processing=!1,this.paymentError="Payment processing failed. Please try again.",console.error("Payment error:",c)}})}}cancelSubscription(){this.currentSubscription!=="free"&&confirm("Are you sure you want to cancel your Pro subscription? You will lose access to premium features.")&&(this.subscriptionService.setSubscription("free"),this.currentSubscription="free",alert("Your subscription has been cancelled. Changes will take effect immediately."),setTimeout(()=>{this.router.navigate(["/dashboard"])},1e3))}isFreePlan(){return this.currentSubscription==="free"}isCurrentPlan(i){return this.currentSubscription===i}hasInvalidClass(i){let c=this.paymentForm.get(i);return!!c&&c.invalid&&(c.dirty||c.touched)}static{this.\u0275fac=function(c){return new(c||r)(v(ae),v(re),v(F),v(N))}}static{this.\u0275cmp=E({type:r,selectors:[["app-subscription"]],decls:87,vars:16,consts:[[1,"text-center","my-5"],[1,"text-center","mb-4"],["color","info",4,"ngIf"],["color","success",4,"ngIf"],["color","success","class","text-center",4,"ngIf"],[1,"justify-content-center","g-4","my-4"],["lg","4","md","6"],[1,"h-100","subscription-card"],[1,"price-tag"],[1,"currency"],[1,"amount"],[1,"period"],[1,"feature-list"],["cIcon","","name","cilCheckAlt",1,"text-success","me-2"],[1,"text-muted"],["cIcon","","name","cilX",1,"text-danger","me-2"],[1,"text-center"],["cButton","","size","lg",1,"px-4",3,"color","disabled"],[4,"ngIf"],[1,"h-100","subscription-card","pro-plan"],["color","primary","position","top-end","shape","rounded-pill",1,"me-3","mt-3"],["cButton","","size","lg",1,"px-4",3,"click","color","disabled"],[1,"text-center","mt-5"],["cButton","","color","secondary","routerLink","/dashboard"],["class","modal-overlay",4,"ngIf"],["color","info"],["color","success"],["color","success",1,"text-center"],[1,"mt-2","mb-0"],[1,"modal-overlay"],[1,"modal-container"],[1,"payment-modal"],[1,"payment-modal-header"],[1,"close-button",3,"click"],[1,"payment-modal-body"],["class","payment-success-animation",4,"ngIf"],["color","danger",4,"ngIf"],[1,"payment-modal-footer"],["cButton","","color","secondary",3,"click"],["cButton","","color","primary",3,"click","disabled"],[1,"payment-success-animation"],[1,"check-icon"],["cIcon","","name","cilCheckAlt","width","40","height","40"],["color","success",1,"mt-3"],["color","danger"],[1,"mt-0"],["cForm","",3,"formGroup"],[1,"mb-3"],["cLabel","","for","cardName"],["cFormControl","","id","cardName","formControlName","cardName","placeholder","John Doe",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["cLabel","","for","cardNumber"],["cFormControl","","id","cardNumber","formControlName","cardNumber","placeholder","1234567890123456",3,"ngClass"],[1,"row"],[1,"col-md-6","mb-3"],["cLabel","","for","expiryDate"],["cFormControl","","id","expiryDate","formControlName","expiryDate","placeholder","MM/YY",3,"ngClass"],["cLabel","","for","cvv"],["cFormControl","","id","cvv","formControlName","cvv","placeholder","123",3,"ngClass"],[1,"invalid-feedback"]],template:function(c,s){c&1&&(t(0,"c-container")(1,"h1",0),n(2,"Subscription Plans"),e(),t(3,"div",1),u(4,se,5,0,"c-alert",2)(5,ce,4,0,"c-alert",3),e(),u(6,le,5,0,"c-alert",4),t(7,"c-row",5)(8,"c-col",6)(9,"c-card",7)(10,"c-card-header")(11,"h3"),n(12,"Free Plan"),e(),t(13,"div",8)(14,"span",9),n(15,"$"),e(),t(16,"span",10),n(17,"0"),e(),t(18,"span",11),n(19,"/month"),e()()(),t(20,"c-card-body")(21,"h5",1),n(22,"Features"),e(),t(23,"ul",12)(24,"li"),d(),l(25,"svg",13),n(26," Single Line Predictions "),e(),p(),t(27,"li"),d(),l(28,"svg",13),n(29," Basic Result History "),e(),p(),t(30,"li"),d(),l(31,"svg",13),n(32," Standard Support "),e(),p(),t(33,"li",14),d(),l(34,"svg",15),p(),t(35,"del"),n(36,"Bulk CSV Predictions"),e()(),t(37,"li",14),d(),l(38,"svg",15),p(),t(39,"del"),n(40,"Advanced Analytics"),e()()()(),t(41,"c-card-footer",16)(42,"button",17),u(43,me,2,0,"span",18)(44,de,2,0,"span",18),e()()()(),t(45,"c-col",6)(46,"c-card",19)(47,"c-badge",20),n(48," RECOMMENDED "),e(),t(49,"c-card-header")(50,"h3"),n(51,"Pro Plan"),e(),t(52,"div",8)(53,"span",9),n(54,"$"),e(),t(55,"span",10),n(56,"19.99"),e(),t(57,"span",11),n(58,"/month"),e()()(),t(59,"c-card-body")(60,"h5",1),n(61,"Features"),e(),t(62,"ul",12)(63,"li"),d(),l(64,"svg",13),n(65," Single Line Predictions "),e(),p(),t(66,"li"),d(),l(67,"svg",13),p(),t(68,"strong"),n(69,"Bulk CSV Predictions"),e()(),t(70,"li"),d(),l(71,"svg",13),n(72," Advanced Analytics "),e(),p(),t(73,"li"),d(),l(74,"svg",13),n(75," Priority Support "),e(),p(),t(76,"li"),d(),l(77,"svg",13),n(78," Unlimited History "),e()()(),p(),t(79,"c-card-footer",16)(80,"button",21),b("click",function(){return s.isCurrentPlan("pro")?s.cancelSubscription():s.selectPlan(s.subscriptionPlans[1])}),u(81,pe,2,0,"span",18)(82,ue,2,0,"span",18),e()()()()(),t(83,"div",22)(84,"button",23),n(85," Return to Dashboard "),e()()(),u(86,ye,18,6,"div",24)),c&2&&(o(4),a("ngIf",s.isCurrentPlan("free")),o(),a("ngIf",s.isCurrentPlan("pro")),o(),a("ngIf",s.currentSubscription==="pro"),o(3),x("border-primary",s.isCurrentPlan("free")),o(33),a("color",s.isCurrentPlan("free")?"success":"secondary")("disabled",!0),o(),a("ngIf",s.isCurrentPlan("free")),o(),a("ngIf",!s.isCurrentPlan("free")),o(2),x("border-primary",s.isCurrentPlan("pro")),o(34),a("color",s.isCurrentPlan("pro")?"danger":"primary")("disabled",!1),o(),a("ngIf",!s.isCurrentPlan("pro")),o(),a("ngIf",s.isCurrentPlan("pro")),o(4),a("ngIf",s.showPaymentModal))},dependencies:[w,T,O,oe,te,W,Z,ee,ne,ie,V,D,J,K,X,z,A,R,j,Y,G,$,U,q,L,B,H],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1050;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.modal-container[_ngcontent-%COMP%]{width:100%;max-width:500px;margin:0 auto;z-index:1051;animation:_ngcontent-%COMP%_slideIn .3s ease-out}.payment-modal[_ngcontent-%COMP%]{background-color:#fff;border-radius:5px;box-shadow:0 4px 20px #00000026;overflow:hidden}.payment-modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #dee2e6;background-color:#f8f9fa}.payment-modal-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-weight:500}.close-button[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;color:#6c757d;cursor:pointer;transition:color .2s}.close-button[_ngcontent-%COMP%]:hover{color:#343a40}.payment-modal-body[_ngcontent-%COMP%]{padding:15px}.payment-modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;padding:15px;border-top:1px solid #dee2e6;background-color:#f8f9fa}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}.subscription-card[_ngcontent-%COMP%]{transition:all .2s ease-in-out;box-shadow:0 6px 12px #0000000d}.subscription-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 12px 20px #0000001a}.pro-plan[_ngcontent-%COMP%]{position:relative;transform:scale(1.05);z-index:1}@media (max-width: 768px){.pro-plan[_ngcontent-%COMP%]{transform:scale(1)}}.price-tag[_ngcontent-%COMP%]{margin-top:15px}.price-tag[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{vertical-align:super;font-size:1.2rem;font-weight:500}.price-tag[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700}.price-tag[_ngcontent-%COMP%]   .period[_ngcontent-%COMP%]{color:#6c757d;font-size:.9rem}.feature-list[_ngcontent-%COMP%]{list-style:none;padding-left:0;margin-bottom:0}.feature-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:8px 0;display:flex;align-items:center}.payment-success-animation[_ngcontent-%COMP%]{text-align:center;padding:20px 0}.payment-success-animation[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto;border-radius:50%;border:3px solid #47c9a2;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_scaleIn .5s ease-out}.payment-success-animation[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{font-size:40px;color:#47c9a2}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(0)}to{transform:scale(1)}}"]})}}return r})();export{$e as SubscriptionComponent};
